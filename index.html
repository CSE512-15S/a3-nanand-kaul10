<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Assignment 3</title>
        <script type="text/javascript" src="d3.js"></script>
		<link rel="stylesheet" type="text/css" href="style.css">
    </head>
    <body>
	    <script type="text/javascript">		
		var w = 800;
		var h = 400;
		var sortOrder=false;
		var padding=30;
		
		d3.json("premierleague.json",function(error,data){
		clubname=data["ClubName"];
		dataset=data["MatchesPlayed"];
		
        var xScale = d3.scale.ordinal()
		.domain(d3.range(dataset.length))
		.rangeRoundBands([0, w], 0.05);

		var yScale = d3.scale.linear()
		.domain([0, d3.max(dataset)])
		.range([0, h]);
			
		//Create SVG element
		var svg = d3.select("body")
		.append("svg")
		.attr("width", w)
		.attr("height", h);

		//Create bars
		svg.selectAll("rect")
		.data(dataset)
		.enter()
		.append("rect")
		.attr("x", function(d, i) {
		return xScale(i);
		})
		.attr("y", function(d) {
		return h - yScale(d);
		})
		.attr("width", xScale.rangeBand())
		.attr("height", function(d) {
		return yScale(d);
		})
		.attr("fill", function(d) {
		for(var i=0;i<dataset.length;i++){
		return "rgb(0, 0, " + (d*10) + ")";
		}
		})
		.on("mouseover", function(d) {
		//Get this bar's x/y values, then augment for the tooltip
		var xPosition = parseFloat(d3.select(this).attr("x")) + xScale.rangeBand() / 2;
		var yPosition = parseFloat(d3.select(this).attr("y")) + 14;

		//Create the tooltip label
		svg.append("text")
		.attr("id", "tooltip")
		.attr("x", xPosition)
		.attr("y", yPosition)
		.attr("text-anchor", "middle")
		.attr("font-family", "sans-serif")
		.attr("font-size", "11px")
		.attr("font-weight", "bold")
		.attr("fill", "black")
		.text(d);	 
        })
		.on("mouseout", function() {
		//Remove the tooltip
		d3.select("#tooltip").remove();			
		})
		.on("click",function(){
		sortBars();
		});
			   

		//On click, update with new data			
		d3.select(".MatchesWon")
		.on("click", function() {

		//New values for dataset
		dataset = data["MatchesWon"];
		yScale.domain([0,d3.max(dataset)]);

		//Update all rects
		svg.selectAll("rect")
		.data(dataset)
		.transition()
		.duration(1500)
		.attr("y", function(d) {
		return h - yScale(d);
		})
		.attr("height", function(d) {
		return yScale(d);
		})
		.attr("fill", function(d) {
		return "rgb(0, 0, " + (d * 10) + ")";
		});

		//Update all labels
		svg.selectAll("text")
		.data(dataset)
		.transition()
		.duration(1100)
		.ease("linear")
		.text(function(d) {
		return d;
		})
		.attr("x", function(d, i) {
		return xScale(i) + xScale.rangeBand() / 2;
		})
		.attr("y", function(d) {
		return h - yScale(d) + 14;
		});
				   				
		});
				
				
		//On click, update with new data			
		d3.select(".MatchesDrawn")
		.on("click", function() {

		//New values for dataset
		dataset = data["MatchesDrawn"];
		yScale.domain([0,d3.max(dataset)]);

		//Update all rects
		svg.selectAll("rect")
		.data(dataset)
		.transition()
		.duration(1500)
		.attr("y", function(d) {
		return h - yScale(d);
		})
		.attr("height", function(d) {
		return yScale(d);
		})
		.attr("fill", function(d) {
		return "rgb(0, 0, " + (d * 10) + ")";
		});

		//Update all labels
		svg.selectAll("text")
		.data(dataset)
		.transition()
		.duration(1100)
		.ease("linear")
		.text(function(d) {
		return d;
		})
		.attr("x", function(d, i) {
		return xScale(i) + xScale.rangeBand() / 2;
		})
		.attr("y", function(d) {
		return h - yScale(d) + 14;
		});
					   				
		});
				
		//On click, update with new data			
		d3.select(".MatchesLost")
		.on("click", function() {

		//New values for dataset
		dataset = data["MatchesLost"];
		yScale.domain([0,d3.max(dataset)]);

		//Update all rects
		svg.selectAll("rect")
		.data(dataset)
		.transition()
		.duration(1500)
		.attr("y", function(d) {
		return h - yScale(d);
		})
		.attr("height", function(d) {
		return yScale(d);
		})
		.attr("fill", function(d) {
		return "rgb(0, 0, " + (d * 10) + ")";
		});

		//Update all labels
		svg.selectAll("text")
		.data(dataset)
		.transition()
		.duration(1100)
		.ease("linear")
		.text(function(d) {
		return d;
		})
		.attr("x", function(d, i) {
		return xScale(i) + xScale.rangeBand() / 2;
		})
		.attr("y", function(d) {
		return h - yScale(d) + 14;
		});
			   				
		});
				
				
		//On click, update with new data			
		d3.select(".GoalsFor")
		.on("click", function() {

		//New values for dataset
		dataset = data["GoalsFor"];
		yScale.domain([0,d3.max(dataset)]);

		//Update all rects
		svg.selectAll("rect")
		.data(dataset)
		.transition()
		.duration(1500)
		.attr("y", function(d) {
		return h - yScale(d);
		})
		.attr("height", function(d) {
		return yScale(d);
		})
		.attr("fill", function(d) {
		return "rgb(0, 0, " + (d * 10) + ")";
		});

		//Update all labels
		svg.selectAll("text")
		.data(dataset)
		.transition()
		.duration(1100)
		.ease("linear")
		.text(function(d) {
		return d;
		})
		.attr("x", function(d, i) {
		return xScale(i) + xScale.rangeBand() / 2;
		})
		.attr("y", function(d) {
		return h - yScale(d) + 14;
		});
				   				
		});
				
		//On click, update with new data			
		d3.select(".GoalsAgainst")
		.on("click", function() {

		//New values for dataset
		dataset = data["GoalsAgainst"];
		yScale.domain([0,d3.max(dataset)]);

		//Update all rects
		svg.selectAll("rect")
		.data(dataset)
		.transition()
		.duration(1500)
		.attr("y", function(d) {
		return h - yScale(d);
		})
		.attr("height", function(d) {
		return yScale(d);
		})
		.attr("fill", function(d) {
		return "rgb(0, 0, " + (d * 10) + ")";
		});

		//Update all labels
		svg.selectAll("text")
		.data(dataset)
		.transition()
		.duration(1100)
		.ease("linear")
		.text(function(d) {
		return d;
		})
		.attr("x", function(d, i) {
		return xScale(i) + xScale.rangeBand() / 2;
		})
		.attr("y", function(d) {
		return h - yScale(d) + 14;
		});
					   				
		});
				
				
				
				
		//On click, update with new data			
		d3.select(".Points")
		.on("click", function() {

		//New values for dataset
		dataset = data["Points"];
		yScale.domain([0,d3.max(dataset)]);

		//Update all rects
		svg.selectAll("rect")
		.data(dataset)
		.transition()
		.duration(1500)
		.attr("y", function(d) {
		return h - yScale(d);
		})
		.attr("height", function(d) {
		return yScale(d);
		})
		.attr("fill", function(d) {
		return "rgb(0, 0, " + (d * 10) + ")";
		});

		//Update all labels
		svg.selectAll("text")
		.data(dataset)
	    .transition()
	    .duration(1100)
	    .ease("linear")
	    .text(function(d) {
		return d;
	    })
	    .attr("x", function(d, i) {
		return xScale(i) + xScale.rangeBand() / 2;
	    })
	    .attr("y", function(d) {
		return h - yScale(d) + 14;
	    });
					   				
		});
				
				
				
		//On click, update with new data			
		d3.select(".MatchesPlayed")
		.on("click", function() {

		//New values for dataset
		dataset = data["MatchesPlayed"];
		yScale.domain([0,d3.max(dataset)]);

		//Update all rects
		svg.selectAll("rect")
	    .data(dataset)
	    .transition()
	    .duration(1500)
	    .attr("y", function(d) {
		return h - yScale(d);
	    })
	    .attr("height", function(d) {
		return yScale(d);
	    })
	    .attr("fill", function(d) {
		return "rgb(0, 0, " + (d * 10) + ")";
	    });

		//Update all labels
		svg.selectAll("text")
	    .data(dataset)
	    .transition()
	    .duration(1100)
	    .ease("linear")
	    .text(function(d) {
		return d;
	    })
	    .attr("x", function(d, i) {
		return xScale(i) + xScale.rangeBand() / 2;
	    })
	    .attr("y", function(d) {
		return h - yScale(d) + 14;
	    });
					   				
		});
				
			
		var sortBars=function(){
		sortOrder=!sortOrder;
		svg.selectAll("rect")
		.sort(function(a,b){
		if(sortOrder){
		return d3.ascending(a,b);
		}
		else{
		return d3.descending(a,b);}
		})
		.transition()
		.delay(function(d,i){
		return i*50;
		})
		.duration(1000)
		.attr("x",function(d,i){
		return xScale(i);
		});
		};
		})
		
		</script>
	<h1><b>English Premier League - Team Performance Analysis</b></h1>
	<h2><i>Season 2014 - 2015</i></h2>
	<h4>Data Courtesy - <a href="http://www.statto.com/football/stats/england/premier-league/2014-2015/table">Statto - EPL Data</a></h4>
	<hr>
	<button class="MatchesPlayed">Matches Played</button>
	<button class="MatchesWon">Matches Won</button>
	<button class="MatchesDrawn">Matches Drawn</button>
	<button class="MatchesLost">Matches Lost</button>
	<button class="GoalsFor">Goals Scored</button>
	<button class="GoalsAgainst">Goals Conceded</button>
	<button class="Points">Total Points</button>
	<hr>
	</body>
</html> 
